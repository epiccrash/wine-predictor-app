<!DOCTYPE html>
<html>
<style>
    .all-divs {
        text-align: justify;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin-left: auto;
        margin-right: auto;
    }

    hr {
        border: solid 1px black;
        width: 100%;
        height: 1px;
        margin: auto;

    }

    .radioButton {
        display: block;
        position: relative;
        padding-left: 35px;
        margin-bottom: 12px;
        cursor: pointer;
        font-size: 22px;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    /* Hide the browser's default radio button */
    .radioButton input {
        position: absolute;
        opacity: 0;
        cursor: pointer;
    }

    /* Create a custom radio button */
    .checkmark {
        position: absolute;
        top: 0;
        left: 0;
        height: 25px;
        width: 25px;
        background-color: #eee;
        border-radius: 50%;
    }

    /* On mouse-over, add a grey background color */
    .radioButton:hover input~.checkmark {
        background-color: #ccc;
    }

    /* When the radio button is checked, add a blue background */
    .radioButton input:checked~.checkmark {
        background-color: rgb(209, 85, 102);
    }

    /* Create the indicator (the dot/circle - hidden when not checked) */
    .checkmark:after {
        content: "";
        position: absolute;
        display: none;
    }

    /* Show the indicator (dot/circle) when checked */
    .radioButton input:checked~.checkmark:after {
        display: block;
    }

    /* Style the indicator (dot/circle) */
    .radioButton .checkmark:after {
        top: 9px;
        left: 9px;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: white;
    }

    .resultTable {
        border: 5px;
        border-color: rgb(220, 148, 158);
        border-style: ridge;
    }

    .column table.resultTable {
        align-items: center;
        display: inline-table;
    }

    .column {
        align-items: center;
        text-align: center;
        float: left;
        width: 50%;
        padding: 5px;
    }

    table.inputTable {
        margin-left: auto;
        margin-right: auto;
    }
</style>

<head>
    <title>Wine Club</title>
</head>

<body>
    <div class="container">
        <br>
        <h1 style="color:rgb(242, 171, 147);text-align:center">Wine Club</h1>
        <hr>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script> 
    </div>

    {% if (results) %}
    {% if (is_predict_quality) %}
    <p style="text-align: center; font-size: 40px;">Your wine has a quality of <mark
            style="color: rgb(209, 85, 102); background-color: white;">{{ results["qualityScore"] }} </mark><mark
            style="font-size: 30px; background-color: white;">(out of 10)</mark></p>
    <p style="text-align: center; font-size: 23px;">This ranks it in the <mark
            style="color: rgb(233, 175, 128); background-color: white;"><strong>{{ (results["qualityRank"]*100) | int
                }}{% if ((((results["qualityRank"]*100) |
                int) | string) | last) == '1' %}st
                {% elif ((((results["qualityRank"]*100) | int) | string) | last) == '2' %}nd
                {% elif ((((results["qualityRank"]*100) | int) | string) | last) == '3' %}rd
                {% else %}th
                {% endif %}</mark>
        </strong> percentile.</p>
    <div class="column">
        <table class="resultTable" style="text-align: center; width: 300px;">
            <tr style="height: 50px;">
                <td style="width: 3px;"></td>
                <th style="width: 190px;"> Fixed acidity</th>
                <td>{{ fixedAcidity }}</td>
            </tr>
            <tr style="height: 50px;">
                <td style="width: 3px;"></td>
                <th style="width: 190px;"> Volatile acidity</th>
                <td> {{ volatileAcidity }}</td>
            </tr>
            <tr style="height: 50px;">
                <td style="width: 3px;"></td>
                <th style="width: 190px;"> Citric acid</th>
                <td> {{ citricAcid }}</td>
            </tr>
            <tr style="height: 50px;">
                <td style="width: 3px;"></td>
                <th style="width: 190px;"> Free sulfur dioxide</th>
                <td> {{ freeSulfurDioxide }}</td>
            </tr>
            <tr style="height: 50px;">
                <td style="width: 3px;"></td>
                <th style="width: 190px;"> Total sulfur dioxide</th>
                <td> {{ totalSulfurDioxide }}</td>
            </tr>
            <tr style="height: 50px;">
                <td style="width: 3px;"></td>
                <th style="width: 190px;"> Sulfates</th>
                <td> {{ sulfates }}</td>
            </tr>
            <tr style="height: 50px;">
                <td style="width: 3px;"></td>
                <th style="width: 190px;"> Alcohol</th>
                <td> {{ alcohol }}</td>
            </tr>
        </table>
    </div>
    <div class="column">
        <table>
            <div id="piechart"></div>

            <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

            <script type="text/javascript">
                // Load google charts
                google.charts.load('current', { 'packages': ['corechart'] });
                google.charts.setOnLoadCallback(drawChart);

                var fixed = '{{results["featureImportance"][0]*100}}';
                var volatile = '{{results["featureImportance"][1]*100}}';
                var citric = '{{results["featureImportance"][2]*100}}';
                var dioxide = '{{results["featureImportance"][3]*100}}';
                var totalDioxide = '{{results["featureImportance"][4]*100}}';
                var sulfate = '{{results["featureImportance"][5]*100}}';
                var alc = '{{results["featureImportance"][6]*100}}';

                // Draw the chart and set the chart values
                function drawChart() {
                    var data = google.visualization.arrayToDataTable([
                        ['Feature Importance', 'Percentage'],
                        ['Fixed Acidity', parseFloat(fixed)],
                        ['Volatile Acidity', parseFloat(volatile)],
                        ['Citric acid', parseFloat(citric)],
                        ['Free sulfer dioxide', parseFloat(dioxide)],
                        ['Total sulfer dioxode', parseFloat(totalDioxide)],
                        ['Sulfates', parseFloat(sulfate)],
                        ['Alcohol', parseFloat(alc)]]);
                    // Optional; add a title and set the width and height of the chart
                    var options = {
                        'title': 'Feature Importance', 'width': 600, 'height': 400, 'colors': ['#e45d74', '#e66c7b', '#e87a82', '#ea8788', '#ec948e', '#eea596', '#f4cba9'], 'is3D': true,
                        chartArea: { width: '100%' }, 'legend': {
                            'maxLines': 1,
                            'textStyle': {
                                'fontSize': 15
                            }
                        }
                    };

                    // Display the chart inside the <div> element with id="piechart"
                    var chart = new google.visualization.PieChart(document.getElementById('piechart'));
                    chart.draw(data, options);
                }
            </script>
        </table>
    </div>
    {% else %}
    <h3 style="text-align: center;">{{ results }}</h3>
    {% endif %}
    <hr>
    {% endif %}
    <br>
    <div class="container">
        <!-- Forms -->
        <div class="all-divs">
            <h4>{{results["allQualityScoresFreq"]["3.0"]}}</h4>
            <ul class="nav nav-tabs" role="tablist"
                style="align-items: center;align-content: center;text-align: center;">
                <li class="nav-item">
                    <a class="nav-link active" href="#predictQuality" aria-controls="predictQuality" role="tab"
                        data-bs-toggle="tab" data-toggle="tab" style="color: rgb(209, 85, 102);">Predict Wine
                        Quality</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#enterQualityInfo" aria-controls="enterQualityInfo" role="tab"
                        data-bs-toggle="tab" data-toggle="tab" style="color: rgb(209, 85, 102);">Contribute
                        Information</a>
                </li>
            </ul>
        </div>
        <br>
    </div>
    <div class="tab-content">
        <h6 style="text-align: center; color: rgb(160, 147, 149);">Enter -1 for a field which you lack data for.
        </h6>
        <br>
        <div role="tabpanel" class="container tab-pane active" id="predictQuality">
            <form action="{{ url_for('predictQuality') }}" method="POST">
                <table class="inputTable">
                    <th style="width: 300px; text-align: center;">
                        <label for="fixedAcidity" class="form-label" style="text-align: center;">Fixed
                            acidity</label>
                        <input id="fixedAcidity" class="form-control" name="fixedAcidity" type="number" min="-1"
                            max="10.0" placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="volatileAcidity" class="form-label">Volatile acidity</label>
                        <input id="volatileAcidity" class="form-control" name="volatileAcidity" type="number" min="-1"
                            max="10.0" placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="citricAcid" class="form-label">Citric acid</label>
                        <input id="citricAcid" class="form-control" name="citricAcid" type="number" min="-1" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="freeSulfurDioxide" class="form-label">Free sulfur dioxide</label>
                        <input id="freeSulfurDioxide" class="form-control" name="freeSulfurDioxide" type="number"
                            min="-1" max="10.0" placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                </table>
                <table class="inputTable">
                    <th style="width: 300px; text-align: center;">
                        <label for="totalSulfurDioxide" class="form-label">Total sulfur dioxide</label>
                        <input id="totalSulfurDioxide" class="form-control" name="totalSulfurDioxide" type="number"
                            min="-1" max="10.0" placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="sulfates" class="form-label">Sulfates</label>
                        <input id="sulfates" class="form-control" name="sulfates" type="number" min="-1" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="alcohol" class="form-label">Alcohol</label>
                        <input id="alcohol" class="form-control" name="alcohol" type="number" min="-1" max="100"
                            placeholder="0-100 (example: 67)" value="-1">
                    </th>
                    <th style="width: 300px; text-align: center;"></th>
                </table>
                <br>
                <div class="all-divs">
                    <label class="radioButton">Red
                        <input id="red" class="form-check-input" name="wineType" type="radio" value="red" checked="checked">
                        </inputid>
                        <span class="checkmark"></span>
                    </label>
                    <label class="radioButton">White
                        <input id="white" class="form-check-input" name="wineType" type="radio" value="white">
                        </inputid>
                        <span class="checkmark"></span>
                    </label>
                    <div class="submit-button">
                        <button style="background-color: rgb(209, 85, 102); border: 0cm; width: 200px;" type="submit"
                            class="btn btn-primary">Get Prediction</button>
                    </div>
                    <br>
                    <br>
                </div>
            </form>
        </div>
        <div role="tabpanel" class="container tab-pane" id="enterQualityInfo">
            <form action="{{ url_for('enterQualityInfo') }}" method="POST">
                <table class="inputTable">
                    <th style="width: 300px; text-align: center;">
                        <label for="fixedAcidity" class="form-label">Fixed acidity</label>
                        <input id="fixedAcidity" class="form-control" type="number" min="-1" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="volatileAcidity" class="form-label">Volatile acidity</label>
                        <input id="volatileAcidity" class="form-control" type="number" min="-1" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="citricAcid" class="form-label">Citric acid</label>
                        <input id="citricAcid" class="form-control" type="number" min="-1" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="freeSulfurDioxide" class="form-label">Free sulfur dioxide</label>
                        <input id="freeSulfurDioxide" class="form-control" type="number" min="-1" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                </table>
                <table class="inputTable">
                    <th style="width: 300px; text-align: center;">
                        <label for="totalSulfurDioxide" class="form-label">Total sulfur dioxide</label>
                        <input id="totalSulfurDioxide" class="form-control" type="number" min="-1" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="sulfates" class="form-label">Sulfates</label>
                        <input id="sulfates" class="form-control" type="number" min="-1" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" value="-1" step="0.1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="alcohol" class="form-label">Alcohol</label>
                        <input id="alcohol" class="form-control" type="number" min="-1" max="100"
                            placeholder="0-100 (example: 67)" value="-1">
                    </th>
                    <th style="width: 300px; text-align: center;">
                        <label for="quality" class="form-label">Quality</label>
                        <input id="quality" class="form-control" type="number" min="0" max="10.0"
                            placeholder="0.0-10.0 (example: 5.5)" step="0.1" required>
                    </th>
                </table>
                <br>
                <div class="all-divs">
                    <label class="radioButton">Red
                        <input id="red" class="form-check-input" name="wineType" type="radio" value="red" checked="checked">
                        </inputid>
                        <span class="checkmark"></span>
                    </label>

                    <label class="radioButton">White
                        <input id="white" class="form-check-input" name="wineType" type="radio" value="white">
                        </inputid>
                        <span class="checkmark"></span>
                    </label>
                    <div class="submit-button">
                        <button style="background-color: rgb(209, 85, 102); border: 0cm; width: 200px;" type="submit"
                            class="btn btn-primary">Submit Data</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    </div>

</body>

</html>